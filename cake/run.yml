parameters:
  Script: 'cakefile.cake'
  Target: 'Default'
  Configuration: 'Release'
  Coverage: '$(Agent.BuildDirectory)/c'
  Artifacts: $(Build.ArtifactStagingDirectory)
  Verbosity: 'Normal'
  ToolsPath: '$(Agent.ToolsDirectory)/dotnet-cake/'

steps:
- script: ${{ format('{2}/dotnet-cake {0} --Target="{1}" --Configuration="$(Configuration)" --Artifacts="$(Artifacts)" --Coverage="$(Coverage)" --verbosity="$(Verbosity)"', parameters.Script, parameters.Target, parameters.ToolsPath) }}
  displayName: 'dotnet cake'
  env:
    Configuration: ${{ parameters.Configuration }}
    Artifacts: ${{ parameters.Artifacts }}
    VstsArtifacts: ${{ parameters.Artifacts }}
    Coverage: ${{ parameters.Coverage }}
    VstsCoverage: ${{ parameters.Coverage }}
    Verbosity: ${{ parameters.Verbosity }}
