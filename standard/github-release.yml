parameters:
  DotNetVersion: "2.2.300"
  DotNet3Version: "3.0.100-preview6-012264"

steps:
  - task: DownloadBuildArtifacts@0
    displayName: "Download GitVersion Variables"
    inputs:
      specificBuildWithTriggering: true
      downloadType: single
      artifactName: Release Notes
      pipelineId: Github Draft Release
      targetPath: $(Build.ArtifactStagingDirectory)

  - task: GitHubRelease@0
    displayName: 'Update GitHub Release'
    inputs:
      gitHubConnection: github
      action: edit
      title: v$(GitVersion.MajorMinorPatch)
      tag: v$(GitVersion.MajorMinorPatch)
      isDraft: true
      isPreRelease: false
      releaseNotesFile: $(Build.ArtifactStagingDirectory)/**/release-v$(GitVersion.MajorMinorPatch).md
    condition: and(succeeded(), eq(variables['Build.SourceBranch'], 'refs/heads/master'))
