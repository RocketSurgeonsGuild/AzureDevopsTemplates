parameters:
  DotNetVersion: "2.2.401"
  DotNet3Version: "3.0.100-preview7-012821"

steps:
  - task: DownloadBuildArtifacts@0
    displayName: "Download Release Notes"
    inputs:
      specificBuildWithTriggering: true
      downloadType: single
      artifactName: Release Notes
      pipelineId: GitHub_Draft_Release
      targetPath: $(Build.ArtifactStagingDirectory)
    condition: and(succeeded(), eq(variables['Build.SourceBranch'], 'refs/heads/master'))

  - task: GitHubRelease@0
    displayName: 'Update GitHub_Release'
    inputs:
      gitHubConnection: github
      action: edit
      title: v$(GitVersion.MajorMinorPatch)
      tag: v$(GitVersion.MajorMinorPatch)
      isDraft: true
      isPreRelease: false
      releaseNotesFile: $(Build.ArtifactStagingDirectory)/Release Notes/release-v$(GitVersion.MajorMinorPatch).md
    condition: and(succeeded(), eq(variables['Build.SourceBranch'], 'refs/heads/master'))
